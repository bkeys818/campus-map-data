{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "type": "object",
    "properties": {
        "locations": {
            "type": "array",
            "items": { "$ref": "definitions.json#/definitions/Location" },
            "minItems": 1,
            "uniqueItems": true
        }
    },
    "additionalProperties": false,
    "required": ["locations"],
    "definitions": {
        "Location": {
            "type": "object",
            "properties": {
                "region": {
                    "$ref": "#/definitions/Region"
                },
                "places": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "title": {
                                "type": "string"
                            },
                            "description": {
                                "type": "string"
                            },
                            "id": {
                                "type": "string",
                                "format": "uuid"
                            },
                            "coordinate": {
                                "type": "object",
                                "properties": { "$ref": "#/definitions/Coordinate" },
                                "additionalProperties": false,
                                "required": ["lat", "lng"]
                            },
                            "address": {
                                "type": "object",
                                "properties": {
                                    "street": { "type": "string" },
                                    "street2": { "type": "string" },
                                    "city": { "type": "string" },
                                    "state": { "type": "string" },
                                    "zip": {
                                        "type": "integer",
                                        "pattern": "\\d{5}"
                                    },
                                    "country": { "type": "string" }
                                },
                                "additionalProperties": false,
                                "required": ["street", "city", "state", "zip", "country"]
                            },
                            "type": {
                                "enum": []
                            },
                            "query": {
                                "type": "array",
                                "description": "A list of strings that when searched will bring up this place.",
                                "items": {
                                    "type": "string"
                                },
                                "uniqueItems": true,
                                "minItems": 1
                            },
                            "url": {
                                "type": "string"
                            },
                            "sub-places": {
                                "type": "array",
                                "allOf": [
                                    {
                                        "$ref": "#/definitions/Sub-Place"
                                    },
                                    {
                                        "Restaurant": {
                                            "type": "object",
                                            "properties": {
                                                "type": { "const": "restaurant" },
                                                "name": { "type": "string" },
                                                "description": { "type": "string" },
                                                "schedule": { "$ref": "#/definitions/Schedule" }
                                            },
                                            "additionalProperties": false,
                                            "required": ["type", "name"]
                                        }
                                    },
                                    {
                                        "Office": {
                                            "type": "object",
                                            "allOf": [
                                                { "$ref": "#/definitions/Sub-Place" },
                                                { "$ref": "#/definitions/Restaurant" }
                                            ],
                                            "properties": {
                                                "type": { "const": "office" },
                                                "phone": { "type": "string" },
                                                "email": { "type": "string" },
                                                "url": { "type": "string" }
                                            },
                                            "additionalProperties": false,
                                            "required": ["type", "name"]
                                        }
                                    },
                                    {
                                        "Restroom": {
                                            "type": "object",
                                            "properties": {
                                                "type": { "const": "restroom" },
                                                "room-number": { "$ref": "#/definitions/Sub-Place/properties/room-number" },
                                                "sex": { "enum": ["male", "female", "unisex", "family" ] }
                                            },
                                            "additionalProperties": false,
                                            "required": ["type", "room-number", "sex"]
                                        }
                                    }
                                ],
                                "minItems": 1,
                                "uniqueItems": true
                            }
                        },
                        "additionalProperties": false,
                        "required": ["title", "id" ,"coordinate", ""]
                    },
                    "minItems": 1,
                    "uniqueItems": true
                }
            },
            "required": ["region"],
            "additionalProperties": false
        },
        "Region": {
            "type": "object",
            "description": "A rectangular geographic region centered around a specific latitude and longitude.",
            "properties": {
                "center": { "$ref": "#/definitions/Coordinate" },
                "lat-meters": {
                    "description": "The north-to-south span of the region (measured in meters) specified as the distance from the center point to the bounds along the north-to-south axis.",
                    "type": "number"
                },
                "lng-meters": {
                    "description": "The east-to-west span of the region (measured in meters) specified as the distance from the center point to the bounds along the east-to-west axis.",
                    "type": "number"
                }
            },
            "required": ["center", "lat-meters", "lng-meters"],
            "additionalProperties": false
        },
        "Coordinate": {
            "type": "object",
            "description": "The latitude and longitude associated with a location, specified using the WGS 84 reference frame.",
            "properties": {
                "lat": {
                    "description": "The latitude of the coordinate",
                    "type": "number"
                },
                "lng": {
                    "description": "The longitude of the coordinate",
                    "type": "number"
                }
            },
            "required": ["lat", "lng"],
            "additionalProperties": false
        },
        "Schedule": {
            "type": "array",
            "items": {
                "Schedule-Component": {
                    "type": "object",
                    "properties": {
                        "days": {
                            "description": "All of the days of the week that `time-ranges` applies to.",
                            "type": "array",
                            "items": {
                                "day": {
                                    "enum": ["sun", "mon", "tue", "wed", "thu", "fri", "sat"]
                                }
                            },
                            "minItems": 1,
                            "uniqueItems": true
                        },
                        "time-ranges": {
                            "type": "array",
                            "items": {
                                "time-range": {
                                    "type": "string",
                                    "format": "\\d{1,2}:\\d{2}-\\d{1,2}:\\d{2}"
                                }
                            },
                            "minItems": 1,
                            "uniqueItems": true
                        }
                    },
                    "additionalProperties": false,
                    "required": [ "days" ]
                }
            },
            "uniqueItems": true,
            "minItems": 1
        },
        "Sub-Place": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string"
                },
                "room-number": {
                    "type": "string",
                    "pattern": "[a-zA-Z0-9]+"
                }
            },
            "required": ["name"]
        }
    }
}